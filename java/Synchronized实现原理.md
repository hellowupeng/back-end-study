# synchronized

*复习（2）*

关键字synchronized可以修饰方法或者以同步块的形式来进行使用，它主要确保多个线程在同一时刻，只能有一个线程处于方法或者同步块中，它保证了线程对变量访问的可见性和排他性。

对于同步块的实现使用了monitorenter和monitorexit指令，而同步方法则是依靠方法修饰符上的ACC_SYNCHRONIZED来完成的。无论采用哪种方式，其本质是对一个对象的监视器（monitor）进行获取，而这个获取过程是排他的，也就是同一时刻只能有一个线程获取到由synchronized所保护对象的监视器。

任意一个对象都拥有自己的监视器，当这个对象由同步块或者这个对象的同步方法调用时，执行方法的线程必须先获取到该对象的监视器才能进入同步块或者同步方法，而没有获取到监视器（执行该方法）的线程会被阻塞在同步块和同步方法的入口处，进入BLOCKED（阻塞）状态。

任意线程对由Synchronized保护的对象（Object）的访问，首先要获得对象（Object）的监视器。如果获取失败，线程进入同步队列，线程状态变为BLOCKED。当访问对象（Object）的前驱（获得了锁的线程）释放了锁，则该释放操作唤醒阻塞在同步队列中的线程，使其重新尝试对监视器的获取。

##### 参考资料

1. 《Java并发编程的艺术》4.3.1 volatile和synchronized关键字


